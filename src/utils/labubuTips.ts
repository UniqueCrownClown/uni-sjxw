export const questionList = [
  "1. 看到未开封的盲盒，你的第一反应是？",
  '2. 朋友送你一个"丑萌"的Labubu，你会？',
  "3. 你更偏爱哪种奇幻场景？",
  "4. 朋友说你最像Labubu家族的？",
  "5. 你收藏玩具的方式更接近？",
  "6. 你最可能对哪句话心动？",
  "7. 你相信Labubu们真的会？",
  "8. 你更抗拒哪种情况？",
  "9. 看到有人高价收隐藏，你会？",
  "10. 你收藏的玩具最常被说？",
  "11. 你更想参加 Labubu 家族的？",
  "12. 最终你希望成为？",
];

export const answerList = [
  "立刻摇盒听声音辨款||纠结选哪个系列更有价值||直接全包，享受拆盒快感||默默观察别人拆完再决定",
  "疯狂吐槽但偷偷摆 C 位||认真研究它的设计理念||给它画小胡子改造造型||担心它半夜会动起来",
  "岩浆巧克力瀑布||精灵蘑菇森林||暗黑古董店||棉花糖云朵",
  "暗黑大佬 —— 骷髅 Labubu||吃货代表 —— 糖果 Labubu||戏精担当 —— 戏法师 Labubu||佛系之王 —— 禅修 Labubu",
  "端盒强迫症患者||只收隐藏款赌徒||DIY 改造狂魔||永远站不稳的佛系玩家",
  "这次隐藏爆率超高！||绝版 Labubu 交换吗？||我帮你改造成全球唯一款||这个底座… 送你了",
  "用角戳快递||半夜开派对||偷吃你零食||暗中保护你",
  "端盒全出基础款||隐藏款有瑕疵||被说是'跟风买'||永远摆不正玩具",
  "冷笑自己抽才有趣||立刻查同款市值||后悔自己卖早了||疑惑'这有啥好抢的 '",
  "又凶又萌||你怎么有这么多稀奇古怪的||你这玩得有点随便啊||玩具就是用来玩的，怎么都藏着呀",
  "地下摇滚音乐会||黑市玩具拍卖会||精灵烘焙大赛||午睡锦标赛",
  "让人又爱又怕的暗黑主角||小精灵的头号智囊||特立独行的艺术家||快乐的咸鱼精灵",
];

export const labubuResultList = [
  {
    id: 1,
    name: "Labubu",
    title: "率真领袖",
    trait:
      "外向直率，自带领导力，偶尔有点小脾气但内心善良，对认可的伙伴会全力守护",
    description:
      "你像Labubu一样，是天生的团队焦点，敢说敢做的性格让你自带感染力。虽然有时会坚持己见，但面对真正在意的人，总会默默收起棱角，用笨拙的方式保护对方。收集玩具时喜欢主导选择权，却愿意把最好的分享给朋友。",
    signature: "「听我的，不会错——但你要是坚持，我陪你」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcqh1x.png",
  },
  {
    id: 2,
    name: "Zimomo",
    title: "好奇冒险家",
    trait: "精力旺盛，对一切新鲜事物充满好奇，行动力超强，偶尔会因为冒失闯小祸",
    description:
      "你像Zimomo一样，永远保持着对世界的好奇心，看到新奇玩具就想立刻拆开探索。喜欢挑战常规玩法，哪怕失败也笑得开心。社交中是活跃气氛的存在，总能发现别人忽略的趣味细节，是团队里的「惊喜制造机」。",
    signature: "「这个看起来好玩！走，试试去？」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcbDdH.png",
  },
  {
    id: 3,
    name: "Mokoko",
    title: "治愈小天使",
    trait: "温柔细腻，共情力强，擅长用小动作传递温暖，有点害羞但内心坚定",
    description:
      "你像Mokoko一样，是朋友眼中的「治愈系存在」。收到礼物会偷偷开心很久，看到别人难过会默默递上安慰。收藏玩具时更在意它们的「故事感」，哪怕是基础款也会精心布置场景，相信每个玩具都有灵魂。",
    signature: "「这个给你… 它会保佑你今天顺利的」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcbwLD.png",
  },
  {
    id: 4,
    name: "Tycoco",
    title: "热情吃货",
    trait: "乐观开朗，对美食和快乐毫无抵抗力，社交圈的「粘合剂」，自带温暖气场",
    description:
      "你像Tycoco一样，走到哪里都能和人打成一片。拆盲盒时会先对着盒子说「拜托给我可爱的那个呀」，收藏柜里总少不了食物主题的款式。朋友聚会永远是你组织，因为你坚信「分享快乐就是双倍快乐」。",
    signature: "「拆盒前先吃块糖！运气会变好哦～」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcbyFA.png",
  },
  {
    id: 5,
    name: "Vos",
    title: "沉默守护者",
    trait: "外冷内热，不善言辞但行动力强，习惯默默付出，是团队里的「可靠后盾」",
    description:
      "你像Vos一样，看似不苟言笑，却会在朋友拆到重复款时默默递上自己的隐藏款。收藏柜整理得一丝不苟，每个玩具都有固定位置。不喜欢喧哗，但关键时刻总能挺身而出，用实力解决问题。",
    signature: "「嗯。需要帮忙的话，叫我」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcbrod.png",
  },
  {
    id: 6,
    name: "Yaya",
    title: "智慧先知",
    trait: "冷静理性，观察力敏锐，总能提前预判趋势，有点神秘但值得信赖",
    description:
      "你像Yaya一样，拆盲盒前会做足功课分析概率，收藏的玩具总能在几年后成为绝版款。朋友纠结时喜欢找你参谋，因为你总能一针见血指出问题核心。相信「万物有灵」，会和玩具说悄悄话。",
    signature: "「我早说过，这个系列值得等」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcbBee.png",
  },
  {
    id: 7,
    name: "Pipo",
    title: "捣蛋鬼才",
    trait: "古灵精怪，脑洞大开，喜欢恶作剧但无恶意，创意力爆棚",
    description:
      "你像Pipo一样，总把玩具摆成搞笑造型拍表情包，拆盒时故意学机器人说话逗朋友。擅长给普通款玩具改造成「限量款」，比如给Labubu画墨镜、给Zimomo加小披风。生活里充满奇思妙想，是大家的「快乐源泉」。",
    signature: "「看我的！这样玩才有意思～」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcb2SP.png",
  },
  {
    id: 8,
    name: "Spooky",
    title: "神秘夜行客",
    trait: "偏爱独处，喜欢暗黑美学，内心敏感细腻，有不为人知的温柔面",
    description:
      "你像Spooky一样，对暗黑系、哥特风玩具情有独钟，收藏柜总在夜晚亮着小灯。看似难以接近，却会记住朋友无意中说的话，悄悄准备惊喜。相信「孤独是创作的源泉」，经常对着玩具发呆构思故事。",
    signature: "「夜晚的玩具，才会露出真面目哦」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcbRQf.png",
  },
  {
    id: 9,
    name: "Pato",
    title: "乐天派",
    trait: "没心没肺，笑点极低，擅长把坏事变好事，自带「幸运体质」",
    description:
      "你像Pato一样，拆到重复款也会笑着说「正好可以组CP」，永远相信下一个就是隐藏款。玩具摆得歪歪扭扭也不介意，觉得「这样才生动」。朋友emo时只要有你在，总能被你的傻乐感染，瞬间治愈。",
    signature: "「哈哈！你看这个歪脖子的样子，好可爱啊」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcb6JI.png",
  },
  {
    id: 10,
    name: "Boo",
    title: "调皮恶作剧",
    trait: "爱捉弄人，喜欢看到别人被吓到又笑出来的样子，内心纯粹简单",
    description:
      "你像Boo一样，会把玩具藏在朋友包里突然出现，拆盒时故意发出「哇——」的夸张叫声。收藏的玩具大多是搞怪造型，比如吐舌头的、做鬼脸的。虽然爱恶作剧，但分寸感极好，永远不会真的让人不快。",
    signature: "「嘘—— 等下吓他们一跳！」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcLPEQ.png",
  },
  {
    id: 11,
    name: "Toko",
    title: "匠心创作者",
    trait: "专注执着，擅长手工改造，追求完美细节，对作品有强烈的责任感",
    description:
      "你像Toko一样，会为玩具制作专属底座和场景，甚至自己捏黏土配件。拆盒时先检查每个细节，有瑕疵会想办法修复而不是抱怨。收藏对你来说是「创作的延续」，每个玩具都承载着你的巧思。",
    signature: "「再等一下，这个角度还能更完美」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcq5jK.png",
  },
  {
    id: 12,
    name: "特别款·星耀Labubu",
    title: "幻彩梦想家",
    trait: "多元包容，兼具多种特质，随情境切换状态，像彩虹一样变幻莫测",
    description:
      "你像特别款星耀Labubu一样，有时热情似Tycoco，有时沉静如Spooky，拆盒时可能冲动也可能理性。收藏的玩具风格跨度极大，从暗黑到治愈无所不包。你不被单一标签定义，认为「多变才是真实的自己」。",
    signature: "「我？我就是我，不一样的烟火呀」",
    bg: "https://s21.ax1x.com/2025/09/01/pVcbcWt.png",
  },
];

const optionRoleMap = [
  // 问题1选项映射 (索引0-3对应4个选项)
  [
    { roleId: 2, weight: 3 }, // 立刻摇盒听声音辨款 → Zimomo(好奇)
    { roleId: 6, weight: 2 }, // 纠结选哪个系列更有价值 → Yaya(理性)
    { roleId: 1, weight: 3 }, // 直接全包 → Labubu(领袖)
    { roleId: 9, weight: 2 }, // 默默观察 → Pato(乐天)
  ],
  // 问题2选项映射
  [
    { roleId: 1, weight: 2 }, // 吐槽但摆C位 → Labubu(直率)
    { roleId: 6, weight: 3 }, // 研究设计 → Yaya(智慧)
    { roleId: 11, weight: 3, roleId2: 7, weight2: 2 }, // 改造造型 → Toko(创作)+Pipo(捣蛋)
    { roleId: 8, weight: 2 }, // 担心半夜动 → Spooky(神秘)
  ],
  // 问题3选项映射
  [
    { roleId: 4, weight: 3 }, // 岩浆巧克力 → Tycoco(吃货)
    { roleId: 3, weight: 3 }, // 精灵蘑菇森林 → Mokoko(治愈)
    { roleId: 8, weight: 3 }, // 暗黑古董店 → Spooky(神秘)
    { roleId: 9, weight: 2 }, // 棉花糖云朵 → Pato(乐天)
  ],
  // 问题4选项映射 (直接对应角色)
  [
    { roleId: 8, weight: 3 }, // 骷髅Labubu → Spooky(暗黑)
    { roleId: 4, weight: 3 }, // 糖果Labubu → Tycoco(吃货)
    { roleId: 7, weight: 3 }, // 戏法师 → Pipo(捣蛋)
    { roleId: 5, weight: 2 }, // 禅修 → Vos(沉默)
  ],
  // 问题5选项映射
  [
    { roleId: 1, weight: 2 }, // 端盒强迫症 → Labubu(掌控)
    { roleId: 6, weight: 3 }, // 只收隐藏 → Yaya(预判)
    { roleId: 11, weight: 3 }, // DIY改造 → Toko(创作)
    { roleId: 9, weight: 3 }, // 佛系玩家 → Pato(乐天)
  ],
  // 问题6选项映射
  [
    { roleId: 6, weight: 2 }, // 隐藏爆率高 → Yaya(理性)
    { roleId: 4, weight: 3 }, // 绝版交换 → Tycoco(社交)
    { roleId: 7, weight: 3 }, // 改造全球唯一 → Pipo(创意)
    { roleId: 5, weight: 2 }, // 送底座 → Vos(守护)
  ],
  // 问题7选项映射
  [
    { roleId: 2, weight: 2 }, // 用角戳快递 → Zimomo(冒失)
    { roleId: 10, weight: 3 }, // 半夜开派对 → Boo(恶作剧)
    { roleId: 4, weight: 2 }, // 偷吃零食 → Tycoco(吃货)
    { roleId: 5, weight: 3 }, // 暗中保护 → Vos(守护)
  ],
  // 问题8选项映射
  [
    { roleId: 6, weight: 2 }, // 全出基础款 → Yaya(预判失败)
    { roleId: 11, weight: 3 }, // 隐藏有瑕疵 → Toko(完美主义)
    { roleId: 1, weight: 2 }, // 被说跟风 → Labubu(反感随波逐流)
    { roleId: 9, weight: 3 }, // 摆不正 → Pato(佛系)
  ],
  // 问题9选项映射
  [
    { roleId: 1, weight: 2 }, // 冷笑自己抽 → Labubu(自信)
    { roleId: 6, weight: 3 }, // 查市值 → Yaya(理性)
    { roleId: 4, weight: 2 }, // 后悔卖早 → Tycoco(惋惜)
    { roleId: 5, weight: 3 }, // 疑惑抢啥 → Vos(淡然)
  ],
  // 问题10选项映射
  [
    { roleId: 8, weight: 3 }, // 又凶又萌 → Spooky(反差)
    { roleId: 7, weight: 2 }, // 稀奇古怪 → Pipo(创意)
    { roleId: 11, weight: 2 }, // 玩得随便 → Toko(不认同)
    { roleId: 3, weight: 3 }, // 藏着呀 → Mokoko(分享)
  ],
  // 问题11选项映射
  [
    { roleId: 1, weight: 3 }, // 摇滚音乐会 → Labubu(领袖)
    { roleId: 6, weight: 2 }, // 黑市拍卖 → Yaya(预判)
    { roleId: 4, weight: 3 }, // 烘焙大赛 → Tycoco(吃货)
    { roleId: 9, weight: 3 }, // 午睡锦标赛 → Pato(乐天)
  ],
  // 问题12选项映射
  [
    { roleId: 8, weight: 3 }, // 暗黑主角 → Spooky(神秘)
    { roleId: 6, weight: 3 }, // 小精灵智囊 → Yaya(智慧)
    { roleId: 11, weight: 2, roleId2: 7, weight2: 2 }, // 特立独行艺术家 → Toko+Pipo
    { roleId: 12, weight: 3 }, // 快乐咸鱼 → 特别款(多元)
  ],
];

// 2. 核心计算函数：根据用户答案返回匹配结果
export function calculateResult(userAnswers: any[], resultList: any[]) {
  // userAnswers格式：[0,2,1,...] 表示每个问题选择的选项索引
  // 初始化得分表
  const scoreMap = resultList.reduce((acc, item) => {
    acc[item.id] = 0;
    return acc;
  }, {});

  // 累加得分
  userAnswers.forEach((optionIndex, questionIndex) => {
    if (optionIndex === null || optionIndex === undefined) return; // 跳过未答题

    const mappings = optionRoleMap[questionIndex][optionIndex];
    // 处理单个角色映射
    if (mappings.roleId) {
      scoreMap[mappings.roleId] += mappings.weight;
    }
    // 处理双角色映射（部分选项关联两个角色）
    if (mappings.roleId2) {
      scoreMap[mappings.roleId2] += mappings.weight2;
    }
  });

  // 找出最高分角色
  let maxScore = -1;
  let matchedRoleId = 1; // 默认角色

  for (const [roleId, score] of Object.entries(scoreMap)) {
    if ((score as number) > maxScore) {
      maxScore = score as number;
      matchedRoleId = Number(roleId);
    }
  }

  // 处理同分情况：优先选择与问题4选项直接关联的角色
  const tieRoles = Object.entries(scoreMap)
    .filter(([_, score]) => score === maxScore)
    .map(([id]) => Number(id));

  if (tieRoles.length > 1) {
    const question4Answer = userAnswers[3]; // 问题4是直接角色关联题
    if (question4Answer !== undefined) {
      const question4Mappings = optionRoleMap[3][question4Answer];
      // 优先匹配问题4关联的角色
      if (tieRoles.includes(question4Mappings.roleId)) {
        matchedRoleId = question4Mappings.roleId;
      }
    }
  }

  // 返回匹配结果
  return resultList.find((item) => item.id === matchedRoleId);
}
